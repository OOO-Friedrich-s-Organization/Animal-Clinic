{% extends "base.html" %}

{% block content %}
<h1 align="center">Расписание</h1>
<table align="center" border="1">
    <tr align="center">
        <th>Отделение</th>
        <th>Доктор</th>
        <th>Специальность</th>
        <th>Понедельник</th>
        <th>Вторник</th>
        <th>Среда</th>
        <th>Четверг</th>
        <th>Пятница</th>
        <th>Суббота</th>
        <th>Воскресенье</th>
    </tr>
    {% set tab_pos = namespace(value=0) %}
    {% set join_pos = namespace(value=0) %}
    {% for d in data %}
        {% for dep in deps %}
            {% for doc in doctors %}
                {% if doc.id == d.doc_id and doc.profession == dep.id %}
                    <tr>
                        {% if tab_pos.value != indexes[join_pos.value] %}
                            {% if tab_pos.value == (indexes[join_pos.value] - 1) %}
                                <td rowspan="2">{{ dep.title }}</td>
                            {% else %}
                            <td>{{ dep.title }}</td>
                            {% endif %}
                        {% else %}
                            {% if join_pos.value < 4 %}
                                {% set join_pos.value = join_pos.value + 1 %}
                            {% endif %}
                        {% endif %}
                        {% set tab_pos.value = tab_pos.value + 1 %}
                            <td>{{ doc.surname }} {{ doc.name[0] }}.{{ doc.sec_name[0] }}.</td>
                            <td>{{ doc.speciality }}</td>
                            <td align="center">{{ d.mon }}</td>
                            <td align="center">{{ d.tue }}</td>
                            <td align="center">{{ d.wed }}</td>
                            <td align="center">{{ d.thu }}</td>
                            <td align="center">{{ d.fri }}</td>
                            <td align="center">{{ d.sat }}</td>
                            <td align="center">{{ d.sun }}</td>
                    </tr>
                {% endif %}
            {% endfor %}
        {% endfor %}
    {% endfor %}
</table>
{% endblock %}